<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Expedition Management</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>


  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    if (localStorage.getItem("isLoggedIn") !== "true") {
      window.location.replace("index.html");
    }
    function initJqDates(id) {
      const $cin = $(`#checkin_${id}`).prop('readOnly', true).attr({ placeholder: 'DD-MM-YYYY', autocomplete: 'off' });
      const $cout = $(`#checkout_${id}`).prop('readOnly', true).attr({ placeholder: 'DD-MM-YYYY', autocomplete: 'off' });

      const opts = {
        changeMonth: true,
        changeYear: true,
        dateFormat: 'dd-mm-yy',
        appendTo: 'body'   // avoids clipping inside overflow containers
      };

      $cin.datepicker(opts);
      $cout.datepicker(opts);
    }
    $(function () {
      $('#date')
        .attr('placeholder', 'DD-MM-YYYY') // ensure placeholder set via JS too
        .datepicker({
          changeMonth: true,          // month dropdown
          changeYear: true,           // year dropdown
          yearRange: 'c-10:c+10',     // 10 years back to 10 ahead
          // dateFormat: 'yy-mm-dd',     // ISO-like format
          dateFormat: 'dd-mm-yy',     // ISO-like format
          showAnim: 'fadeIn',
          autocomplete: 'off'
        });
      $('#startDate')
        .attr('placeholder', 'DD-MM-YYYY') // ensure placeholder set via JS too
        .datepicker({
          changeMonth: true,          // month dropdown
          changeYear: true,           // year dropdown
          yearRange: 'c-10:c+10',     // 10 years back to 10 ahead
          dateFormat: 'dd-mm-yy',     // ISO-like format
          showAnim: 'fadeIn'
        });
      $('#endDate')
        .attr('placeholder', 'DD-MM-YYYY') // ensure placeholder set via JS too
        .datepicker({
          changeMonth: true,          // month dropdown
          changeYear: true,           // year dropdown
          yearRange: 'c-10:c+10',     // 10 years back to 10 ahead
          dateFormat: 'dd-mm-yy',     // ISO-like format
          showAnim: 'fadeIn'
        });
      initJqDates(1);
    });
    $(document).ready(function () {
      // Get today's date in 'DD-MM-YYYY' format
      const today = new Date();
      const dd = String(today.getDate()).padStart(2, '0');
      const mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
      const yyyy = today.getFullYear();
      const formattedDate = dd + '-' + mm + '-' + yyyy;

      // Set the default date in the input field
      $('#date').val(formattedDate);

      $('#activityCount_1').val(1);

      // // Initialize the datepicker
      // $('#date')
      //   .attr('placeholder', 'DD-MM-YYYY') // ensure placeholder set via JS too
      //   .datepicker({
      //     changeMonth: true,          // month dropdown
      //     changeYear: true,           // year dropdown
      //     yearRange: 'c-10:c+10',     // 10 years back to 10 ahead
      //     dateFormat: 'dd-mm-yy',     // Custom format
      //     showAnim: 'fadeIn',
      //     autocomplete: 'off'
      //   });
    });
  </script>
  <script src="js/script.js?v=1"></script>

</head>

<body class="bg-gradient-to-br from-cyan-50 to-green-50 text-gray-800 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-lg">
    <div class="flex justify-between items-center px-6">
      <!-- Navigation -->
      <nav class="flex justify-center gap-8 py-4">
        <a href="dashboard.html" class="font-semibold hover:text-green-200">Home</a>
        <a href="roomType.html" class="font-semibold hover:text-green-200">Room Type</a>
        <a href="tour.html" class="font-semibold hover:text-green-200">Tour</a>
        <a href="activity.html" class="font-semibold hover:text-green-200">Activity</a>
        <a href="invoice.html" class="font-semibold hover:text-green-200">Invoice</a>
        <a href="expenditure.html" class="font-semibold hover:text-green-200">Expedition Invoice</a>
      </nav>

      <!-- Logout Button -->
      <button onclick='logOut(event)'
        class="flex items-center gap-2 bg-white text-green-600 font-semibold px-4 py-2 rounded-lg shadow hover:bg-green-100 transition">
        <!-- Heroicon Logout (Arrow Right On Door) -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6A2.25 2.25 0 005.25 5.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" />
        </svg>
        Logout
      </button>
    </div>
  </header>

  <!-- Page Content -->
  <main class="flex-1 flex justify-center items-start px-4 py-10">
    <form id="expenditInvoice" class="bg-white rounded-lg shadow-xl w-full max-w-5xl overflow-hidden">
      <!-- Header -->
      <div class="bg-gradient-to-r from-green-500 to-teal-500 p-4">
        <h2 class="text-center text-xl sm:text-2xl lg:text-3xl font-bold text-white">Expedition Invoice Form</h2>
      </div>
      <div class="flex flex-wrap space-x-4 px-4 py-2">
        <label class="inline-flex items-center mb-2">
          <input type="radio" name="invoiceMode" value="new" checked class="h-4 w-4 text-green-600 focus:ring-green-500"
            id="newInvoice">
          <span class="ml-2 text-gray-700">New Invoice</span>
        </label>
        <label class="inline-flex items-center mb-2">
          <input type="radio" name="invoiceMode" value="edit" class="h-4 w-4 text-green-600 focus:ring-green-500"
            id="editInvoice">
          <span class="ml-2 text-gray-700">Edit Invoice</span>
        </label>
      </div>

      <div id="editInvoiceFields" class="hidden px-4 py-4 space-y-4">

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">

          <div>
            <label for="startDate" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Start
              Date</label>
            <input type="text" id="startDate" name="startDate"
              class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
          </div>

          <div>
            <label for="endDate" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">End Date</label>
            <input type="text" id="endDate" name="endDate"
              class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
          </div>

          <div>
            <label for="invoiceNo" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Invoice
              Search</label>
            <input type="text" id="invoiceNo" name="invoiceNo" placeholder="Search by invoice ID"
              class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
          </div>

          <div class="flex items-end">
            <button type="button" onclick="getExpenditFormDetails(event)" id="invoiceSearchID"
              class="w-full sm:w-auto px-4 py-3 bg-green-500 text-white font-semibold rounded-lg shadow-md transform transition hover:-translate-y-1 hover:shadow-lg">
              Search
            </button>
          </div>
          <div>
            <label for="expenditFormID" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Invoice
              ID</label>
            <select id="expenditFormID" name="expenditFormID" onfocus=""
              class="occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
              <option value="">-- Select --</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Form Content -->
      <div class="p-4">
        <!-- Basic Info Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6">
          <div>
            <label for="guest" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Guest
              Detail</label>
            <input type="text" id="guest" name="guest" placeholder="Enter guest name"
              class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
          </div>
          <div>
            <label for="date" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Invoice
              Date</label>
            <input type="text" id="date" name="date"
              class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
          </div>
        </div>

        <!-- Tour Details Container -->
        <div class="bg-gray-50 rounded-lg p-4 sm:p-6 mb-6">
          <div class="flex items-center mb-4">
            <button type="button" id="addTourGroupBtn"
              class="bg-gradient-to-r from-green-500 to-teal-500 hover:bg-green-600 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 transition-colors">
              <i class="fa-solid fa-plus"></i>
            </button>
            <span class="text-lg font-semibold text-gray-800">Tour Details</span>
          </div>

          <!-- Tour input groups container -->
          <div id="tour-group-container">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4 items-end" data-tour-group-id="1">

              <div>
                <label for="tourName_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tour
                  Name
                </label>
                <select id="tourName_1" name="tourName_1" onfocus="getTourName(event)"
                  class="occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                </select>
              </div>

              <div>
                <label for="checkin_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Check-in
                  Date</label>
                <input type="text" id="checkin_1" name="checkin_1"
                  class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
              </div>

              <div>
                <label for="checkout_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Check-out
                  Date</label>
                <input type="text" name="checkout_1" id="checkout_1"
                  class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
              </div>

              <!-- <div>
                <label for="sacCode_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">SAC
                  Code</label>
                <input type="text" name="sacCode_1" id="sacCode_1"
                  class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="SAC code">
              </div> -->

              <div>
                <label for="pax_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">No of Pax</label>
                <input type="number" name="pax_1" id="pax_1"
                  class="expendit-pax w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="rate_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Rate (₹)</label>
                <input type="number" name="rate_1" id="rate_1"
                  class="expendit-rate w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="taxRate_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tax
                  Rate</label>
                <select name="taxRate_1" id="taxRate_1" onfocus="getTaxRate(event)"
                  class="expendit-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                </select>
              </div>

              <div>
                <label for="extraTaxRate_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Extra
                  Tax
                  Rate</label>
                <select name="extraTaxRate_1" id="extraTaxRate_1"
                  class="expendit-extraTaxRate occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                  <option value="5">5%</option>
                  <option value="20">20%</option>
                </select>
              </div>

              <div class="flex items-end">
                <div class="w-full">
                  <label for="tourTotal_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Total
                    (₹)</label>
                  <input type="number" name="tourTotal_1" id="tourTotal_1"
                    class="tour-total w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                    placeholder="0">
                </div>
                <button type="button"
                  class="tour-minus-btn bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center ml-2 transition-colors hidden">
                  <i class="fa-solid fa-minus"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Activity input groups container -->
        <div class="bg-gray-50 rounded-lg p-4 sm:p-6 mb-6">
          <div class="flex items-center mb-4">
            <button type="button" id="addActivityGroupBtn"
              class="bg-gradient-to-r from-green-500 to-teal-500 hover:bg-green-600 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 transition-colors">
              <i class="fa-solid fa-plus"></i>
            </button>
            <span class="text-lg font-semibold text-gray-800">Activity Details</span>
          </div>

          <!-- Activity input groups container -->
          <div id="activity-group-container">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4 items-end" data-activity-group-id="1">

              <div>
                <label for="activityName_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Activity
                  Name</label>
                <select name="activityName_1" id="activityName_1" onfocus="getExpenditActivityName(event)"
                  class="activity-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                </select>
              </div>

              <!-- <div>
                <label for="activitySacCode_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">SAC
                  Code</label>
                <input type="text" name="activitySacCode_1" id="activitySacCode_1"
                  class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="SAC code">
              </div> -->

              <div>
                <label for="activityCount_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">No of
                  Activities</label>
                <input type="number" name="activityCount_1" id="activityCount_1"
                  class="activity-count w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="activityRate_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Rate
                  (₹)</label>
                <input type="number" name="activityRate_1" id="activityRate_1"
                  class="activity-rate w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="activityTaxRate_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tax
                  Rate</label>
                <select name="activityTaxRate_1" id="activityTaxRate_1" onfocus="getTaxRate(event)"
                  class="activity-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                </select>
              </div>

              <div class="flex items-end">
                <div class="w-full">
                  <label for="activityTotal_1" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Total
                    (₹)</label>
                  <input type="number" name="activityTotal_1" id="activityTotal_1"
                    class="activity-total w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                    placeholder="0">
                </div>
                <button type="button"
                  class="activity-minus-btn bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center ml-2 transition-colors hidden">
                  <i class="fa-solid fa-minus"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- Advance Details Container -->
        <div class="bg-gray-50 rounded-lg p-4 sm:p-6 mb-6">
          <div class="flex items-center mb-4">
            <span class="text-lg font-semibold text-gray-800">Advance Details</span>
          </div>

          <!-- Activity input groups container -->
          <div id="activity-group-container">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4 items-end">
              <div>
                <label for="advanceAmt" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Advance
                  Amount</label>
                <input type="number" name="advanceAmt" id="advanceAmt"
                  class="advanceAmt w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>
            </div>
          </div>
        </div>
        <!-- Submit Button -->
        <div class="flex justify-center">
          <button type="submit" id="submitButton" onclick="handleExpenditureForm(event)"
            class="w-full sm:w-auto sm:min-w-[200px] px-8 py-3 sm:py-2 text-white font-semibold rounded-lg bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 active:from-green-700 active:to-teal-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 text-base sm:text-lg">
            Submit Invoice
          </button>
        </div>
      </div>
    </form>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white text-center py-3 mt-12 text-sm">
    &copy; 2025 Your Company. All rights reserved.
  </footer>

  <script>
    const form = document.getElementById('expenditInvoice')

    document.getElementById('newInvoice').addEventListener('change', function () {
      document.getElementById('editInvoiceFields').classList.add('hidden');
    });

    document.getElementById('editInvoice').addEventListener('change', function () {
      document.getElementById('editInvoiceFields').classList.remove('hidden');
    });

    document.getElementById('newInvoice').addEventListener('change', function () {
      if (this.checked) {
        window.location.reload();
      }
    });
    // document.getElementById('editInvoice').addEventListener('change', function () {
    //   if (this.checked) {
    //     form.reset();
    //   }
    // });
    // Initialize counters for tour and activity groups
    let tourGroupCounter = 1;
    let activityGroupCounter = 1;

    // Initialize the form
    // document.addEventListener('DOMContentLoaded', function () {
    //   // Set today's date as default for checkin/checkout
    //   const today = new Date();
    //   document.getElementById('checkin').valueAsDate = today;

    //   const tomorrow = new Date(today);
    //   tomorrow.setDate(tomorrow.getDate() + 1);
    //   document.getElementById('checkout').valueAsDate = tomorrow;

    //   // Add event listeners for calculation
    //   setupTourCalculationListeners();
    //   setupActivityCalculationListeners();

    //   // Update minus buttons visibility
    //   updateTourMinusButtons();
    //   updateActivityMinusButtons();
    // });

    // Add tour group
    document.getElementById('addTourGroupBtn').addEventListener('click', function (e) {
      e.preventDefault();
      addTourGroup();
    });

    // Add activity group
    document.getElementById('addActivityGroupBtn').addEventListener('click', function (e) {
      e.preventDefault();
      addActivityGroup();
    });

    function addTourGroup() {
      tourGroupCounter++;
      const tourGroupContainer = document.getElementById('tour-group-container');

      const newTourGroup = document.createElement('div');
      newTourGroup.classList.add('grid', 'grid-cols-1', 'sm:grid-cols-2', 'lg:grid-cols-5', 'gap-4', 'mb-4', 'items-end');
      newTourGroup.setAttribute('data-tour-group-id', tourGroupCounter);

      newTourGroup.innerHTML = `
       
        <div>
            <label for="tourName_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tour
                Name
            </label>
              <select id="tourName_${tourGroupCounter}" name="tourName_${tourGroupCounter}" onfocus="getTourName(event)"
                  class="occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                <option value="">-- Select --</option>
              </select>
        </div>

        <div>
          <label for="checkin_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Check-in
              Date</label>
          <input type="text" name="checkin_${tourGroupCounter}" id="checkin_${tourGroupCounter}"
            class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
        </div>

        <div>
          <label for="checkout_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Check-out
            Date</label>
          <input type="text" name="checkout_${tourGroupCounter}" id="checkout_${tourGroupCounter}"
            class="w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
        </div>

        

        <div>
          <label for="pax_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">No of Pax</label>
          <input type="number" name="pax_${tourGroupCounter}" id="pax_${tourGroupCounter}"
            class="expendit-pax w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
            placeholder="0">
        </div>

        <div>
          <label for="rate_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Rate (₹)</label>
          <input type="number" name="rate_${tourGroupCounter}" id="rate_${tourGroupCounter}"
            class="expendit-rate w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
            placeholder="0">
        </div>

        <div>
          <label for="taxRate_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tax
            Rate</label>
          <select name="taxRate_${tourGroupCounter}" id="taxRate_${tourGroupCounter}" onfocus="getTaxRate(event)"
            class="expendit-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
           <option value="${defaultTaxRate}">${defaultTaxRate}%</option>
            </select>
        </div>

        <div>
          <label for="extraTaxRate_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Extra
            Tax
            Rate</label>
          <select name="extraTaxRate_${tourGroupCounter}" id="extraTaxRate_${tourGroupCounter}"
            class="expendit-extraTaxRate occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
            <option value="">-- Select --</option>
            <option value="5">5%</option>
            <option value="20">20%</option>
          </select>
        </div>

        <div class="flex items-end">
          <div class="w-full">
            <label for="tourTotal_${tourGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Total (₹)</label>
            <input type="number" name="tourTotal_${tourGroupCounter}" id="tourTotal_${tourGroupCounter}"
              class="tour-total w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
              placeholder="0">
          </div>
          <button type="button" class="tour-minus-btn bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center ml-2 transition-colors">
            <i class="fa-solid fa-minus"></i>
          </button>
        </div>
      `;

      tourGroupContainer.appendChild(newTourGroup);

      initJqDates(tourGroupCounter)
      // Update minus buttons visibility
      updateTourMinusButtons();

      console.log(`Added tour group #${tourGroupCounter}`);
    }

    function addActivityGroup() {
      activityGroupCounter++;
      const activityGroupContainer = document.getElementById('activity-group-container');

      const newActivityGroup = document.createElement('div');
      newActivityGroup.classList.add('grid', 'grid-cols-1', 'sm:grid-cols-2', 'lg:grid-cols-5', 'gap-4', 'mb-4', 'items-end');
      newActivityGroup.setAttribute('data-activity-group-id', activityGroupCounter);

      newActivityGroup.innerHTML = `

              <div>
                <label for="activityName_${activityGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Activity
                  Name</label>
                <select name="activityName_${activityGroupCounter}" id="activityName_${activityGroupCounter}" onfocus="getExpenditActivityName(event)"
                  class="activity-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                  <option value="">-- Select --</option>
                </select>
              </div>

              

              <div>
                <label for="activityCount_${activityGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">No of
                  Activities</label>
                <input type="number" name="activityCount_${activityGroupCounter}" id="activityCount_${activityGroupCounter}"
                  class="activity-count w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="activityRate_${activityGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Rate
                  (₹)</label>
                <input type="number" name="activityRate_${activityGroupCounter}" id="activityRate_${activityGroupCounter}"
                  class="activity-rate w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                  placeholder="0">
              </div>

              <div>
                <label for="activityTaxRate_${activityGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Tax
                  Rate</label>
                <select name="activityTaxRate_${activityGroupCounter}" id="activityTaxRate_${activityGroupCounter}" onfocus="getTaxRate(event)"
                  class="activity-tax occupancy w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base">
                 <option value="${defaultTaxRate}">${defaultTaxRate}%</option>
                </select>
              </div>

              <div class="flex items-end">
                <div class="w-full">
                  <label for="activityTotal_${activityGroupCounter}" class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">Total
                    (₹)</label>
                  <input type="number" name="activityTotal_${activityGroupCounter}" id="activityTotal_${activityGroupCounter}"
                    class="activity-total w-full p-3 sm:p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 text-sm sm:text-base"
                    placeholder="0">
                </div>
                <button type="button"
                  class="activity-minus-btn bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center ml-2 transition-colors hidden">
                  <i class="fa-solid fa-minus"></i>
                </button>
              </div>
      `;

      activityGroupContainer.appendChild(newActivityGroup);


      // Update minus buttons visibility
      updateActivityMinusButtons();

      // console.log(`Added activity group #${activityGroupCounter}`);
    }

    // Remove tour group
    function removeTourGroup(button) {
      const tourGroup = button.closest('[data-tour-group-id]');
      const groupId = tourGroup.getAttribute('data-tour-group-id');

      tourGroup.remove();

      // Update minus buttons visibility
      updateTourMinusButtons();

      console.log(`Removed tour group #${groupId}`);
    }

    // Remove activity group
    function removeActivityGroup(button) {
      const activityGroup = button.closest('[data-activity-group-id]');
      const groupId = activityGroup.getAttribute('data-activity-group-id');

      activityGroup.remove();

      // Update minus buttons visibility
      updateActivityMinusButtons();

      // console.log(`Removed activity group #${groupId}`);
    }

    // Update tour minus buttons visibility
    function updateTourMinusButtons() {
      const allTourGroups = document.querySelectorAll('[data-tour-group-id]');

      allTourGroups.forEach((group, index) => {
        const minusBtn = group.querySelector('.tour-minus-btn');

        // Hide the minus button if it's the only tour group
        if (allTourGroups.length === 1) {
          minusBtn.classList.add('hidden');
        } else {
          minusBtn.classList.remove('hidden');
        }

        // Add event listener if not already added
        minusBtn.onclick = function () { removeTourGroup(this); };
      });
    }

    // Update activity minus buttons visibility
    function updateActivityMinusButtons() {
      const allActivityGroups = document.querySelectorAll('[data-activity-group-id]');

      allActivityGroups.forEach((group, index) => {
        const minusBtn = group.querySelector('.activity-minus-btn');

        // Hide the minus button if it's the only activity group
        if (allActivityGroups.length === 1) {
          minusBtn.classList.add('hidden');
        } else {
          minusBtn.classList.remove('hidden');
        }

        // Add event listener if not already added
        minusBtn.onclick = function () { removeActivityGroup(this); };
      });
    }

  </script>
  <div id="toast-container" class="toast-container"></div>

</body>

</html>